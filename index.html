<html class="darkmode">
    <head>
        <title>Star Wars: Unlimited Offline Judge Tool</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
        <link rel="icon" href="images/judge.ico">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="cards_data.js"></script>
        <script src="pdf_images.js"></script>
        <script type="text/javascript" src="https://acrobatservices.adobe.com/view-sdk/viewer.js"></script>
        <meta http-equiv="Content-Disposition" content="attachment; filename=rules_documents/Star_Wars_Unlimited_Comp_Rules_6_0_d3d16e8da4.pdf">
        <meta http-equiv="Content-Disposition" content="attachment; filename=rules_documents/Star_Wars_Unlimited_Comprehensive_Event_Guide_a34d99b91d.pdf">
    </head>
    <body>
        <div class="stickyContent">
            <h1><span>Star Wars: Unlimited Judge Tool</span><svg onclick="toggleMenu();" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M64 360a56 56 0 1 0 0 112 56 56 0 1 0 0-112zm0-160a56 56 0 1 0 0 112 56 56 0 1 0 0-112zM120 96A56 56 0 1 0 8 96a56 56 0 1 0 112 0z"/></svg></h1>
            <nav>
                <div id="cardDataTab" class="activeTab" onclick="$('#searchInput').prop('disabled', false);$('.contentContainer').hide();$('#cardDataContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');">Cards</div>
                <div id="ruleDataTab" onclick="$('#searchInput').prop('disabled', false);$('.contentContainer').hide();$('.activeTab').removeClass('activeTab');$('#ruleDataContainer').show(); $(this).addClass('activeTab');">Additional Rulings</div>
                <div id="crDataTab" onclick="$('#searchInput').prop('disabled', true);$('.contentContainer').hide();$('#crContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');docLoaded('cr')">CR v6.0.0</div>
                <div id="cegDataTab" onclick="$('#searchInput').prop('disabled', true);$('.contentContainer').hide();$('#cegContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');docLoaded('ceg');">CEG</div>
                <div id="clarificationDataTab" onclick="$('#searchInput').prop('disabled', true);$('.contentContainer').hide();$('#ruleClarificationContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');">Rules Clarifications</div>
                <div id="policyDataTab" onclick="$('#searchInput').prop('disabled', true);$('.contentContainer').hide();$('#policyClarificationContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');">Policy Clarifications</div>
                <div id="legalityDataTab" onclick="$('#searchInput').prop('disabled', true);$('.contentContainer').hide();$('#legalityContainer').show();$('.activeTab').removeClass('activeTab');$(this).addClass('activeTab');">Card Legality</div>
            </nav>
            <search>
                <input type="text" id="searchInput" placeholder="Search in Cards and Additional Rulings..." oninput="updateSearch();">
                <div id="colorToggle" class="darkmode" onclick="$(this).toggleClass('darkmode');$('#darkmode').toggle();$('html').toggleClass('darkmode');"><div></div></div>
            </search>
        </div>
        <div class="content">
            <div class="contentContainer" id="cardDataContainer">
                <div class="sectionDescription">This is a list of all cards alphabetically. Select a card to view its images, text, and known rulings. (Updated 01/08/2026)</div>
                <div class="sectionContent" id="cardContent"></div> 
            </div>
            <div class="contentContainer" id="ruleDataContainer" style="display: none;">
                <div class="sectionDescription">This is a list of all known additional rulings from the SWU website. Rules are grouped by set, then alphabetically by card name, then by date. (Updated 01/08/2026)</div>
                <div class="sectionContent" id="ruleContent"></div> 
            </div>
            <div class="contentContainer" id="crContainer" style="display:none;">
                <div><a class="pdfLink" target="_blank" href="rules_documents/Star_Wars_Unlimited_Comp_Rules_6_0_d3d16e8da4.pdf">Direct Link to PDF</a></div>
                <object onload="docLoaded('cr');" onerror="$(this).hide();$('#crFallback').show();" data="rules_documents/Star_Wars_Unlimited_Comp_Rules_6_0_d3d16e8da4.pdf" type="application/pdf" width="100%" height="100%">
                    <param name="download" value="true">
                </object>
                <div class="pdfMessage">If you are only able to see an image of the first page of the PDF or you see this message above the PDF, your browser does not support the PDF viewer. Please click the link above to view and download the PDF from there so it is available to you offline.</div>
                <div id="crFallback" style="display: none;"><div></div></div>
            </div>
            <div class="contentContainer" id="cegContainer" style="display:none;">
                <div><a class="pdfLink" target="_blank" href="rules_documents/Star_Wars_Unlimited_Comprehensive_Event_Guide_a34d99b91d.pdf">Direct Link to PDF</a></div>
                <object onload="docLoaded('ceg');" onerror="$(this).hide();$('#cegFallback').show();" data="rules_documents/Star_Wars_Unlimited_Comprehensive_Event_Guide_a34d99b91d.pdf" type="application/pdf" width="100%" height="100%">
                    <param name="download" value="true">
                </object>
                <div class="pdfMessage">If you are only able to see an image of the first page of the PDF or you see this message above the PDF, your browser does not support the PDF viewer. Please click the link above to view and download the PDF from there so it is available to you offline.</div>
                <div id="cegFallback" style="display: none;"><div></div></div>
            </div>
            <div class="contentContainer" id="ruleClarificationContainer" style="display:none;">
                <div class="sectionContent">Coming Soon!</div>
            </div>
            <div class="contentContainer" id="policyClarificationContainer" style="display:none;">
                <div class="sectionContent">Coming Soon!</div>
            </div>
            <div class="contentContainer" id="legalityContainer" style="display:none;">
                <div class="sectionContent">
                    <h3>Card Legality Terms</h3>
                    <ul>
                        <li><b>Suspended: </b>This means that the card is currently illegal to play in the associated format. Suspended cards are reviewed every few months, likely around set releases. Cards that are suspended may be removed from the suspended list.</li>
                        <li><b>Banned: </b>This means that the card is permanently illegal to play in the associated format. There are currently no banned cards.</li>
                        <li><b>Restricted: </b>This means that the card is limited in what other cards can be in a deck with it or limited in what quantities it can be played in. There are currently no restricted cards.</li>
                    </ul>
                    <hr>
                    <h1>Premier</h1>
                    <h2>Suspended Cards</h2>
                    <ul>
                        <li>Boba Fett - Collecting the Bounty</li>
                        <li>Jango Fett - Concealing the Conspiracy</li>
                        <li>DJ - Blatant Thief</li>
                        <li>Triple Dark Raid</li>
                        <li>Force Throw</li>
                    </ul>
                    <h2>Banned Cards</h2>
                    <ul>
                        <li>N/A</li>
                    </ul>
                    <h2>Restricted Cards</h2>
                    <ul>
                        <li>N/A</li>
                    </ul>
                    <hr>
                    <h1>Twin Suns</h1>
                    <h2>Suspended Cards</h2>
                    <ul>
                        <li>N/A</li>
                    </ul>
                    <h2>Banned Cards</h2>
                    <ul>
                        <li>N/A</li>
                    </ul>
                    <h2>Restricted Cards</h2>
                    <ul>
                        <li>N/A</li>
                    </ul>
                </div>
            </div>
        </content>
        <style>
            html {
                background-color: var(--background-color);
                font-family: "Space Mono", monospace !important;
                font-weight: 400;
                font-style: normal;
                color: var(--color-text);
                font-size: var(--font-size);
            }
            html {
                --background-color: #f6f6f6;
                --background-header: #f6f6f6;
                --color-darker: #ececec;
                --color-disabled: #fbfaff;
                --color-lighter: #ebebeb;
                --color-input: #ffffff;
                --color-placeholder: #d7d9d9;
                --color-text: #2f2f2f;
                --color-border: #dadada;
                --color-selected: #d5d5d5;
                --color-link: #4abdb9;
                --color-error: #c1191e;
                --font-size: 14px;
                --shadow: 0px 0px 0.5rem rgba(201, 201, 201, 0.3);
                --shadow-inset: inset 0px 0px 10px rgba(157, 157, 157, 0.3);
            }
            html.darkmode {
                --background-color: #2f2e34;
                --background-header: #29282d;
                --color-darker: #29282d;
                --color-disabled: #29282d;
                --color-lighter: #343339;
                --color-input: #343339;
                --color-placeholder: #6f6d77;
                --color-text: #d4d6da;
                --color-border: #403f45;
                --color-selected: #434248;
                --color-link: #4abdb9;
                --color-error: #c1191e;
                --shadow: 0px 0px 0.5rem rgba(0, 0, 0, 0.3);
                --shadow-inset: inset 0px 0px 10px rgba(0, 0, 0, 0.3);
            }
            body {
                margin: auto;
                background-color: var(--background-color);
                padding: 0;
                box-sizing: border-box;
            }
            .stickyContent {
                position: sticky;
                top: 0;
                background-color: var(--background-header);
                border-bottom: 1px solid var(--color-border);
                padding: 1rem;
                box-sizing: border-box;
            }
            h1 {
                font-size: 2rem;
                line-height: 2rem;
                margin-top: 0;
            }
            nav {
                display: flex;
                flex-direction: row;
                justify-content: flex-start;
                gap: 0.5rem;
                border-bottom: 1px solid var(--color-border);
                width: 100%;
                padding-bottom: 1rem;
                margin-bottom: 1rem;
                box-sizing: border-box;
                user-select: none;
                flex-wrap: wrap;
            }
            nav > div {
                cursor: pointer;
                padding: 0.25rem 0.5rem;
                border: 1px solid var(--color-border);
                border-radius: 0.25rem;
                box-shadow: var(--shadow);
            }
            .activeTab {
                background-color: var(--color-selected);
            }
            a {
                color: var(--color-link);
            }
            search {
                width: 100%;
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: flex-start;
                gap: 0.5rem;
                box-sizing: border-box;
            }
            search ::placeholder {
                font-family: 'Space Mono', monospace;
                font-size: 0.75rem;
                color: var(--color-placeholder);
            }
            search input {
                width: 100%;
                padding: 0.5rem 0.5rem;
                border: 1px solid var(--color-border);
                border-radius: 0.25rem;
                box-shadow: var(--shadow);
                font-family: 'Space Mono', monospace;
                background-color: var(--color-input);
                color: var(--color-text);
            }
            search input:disabled {
                background-color: var(--color-disabled);
                box-shadow: var(--shadow-inset);
                color: #ABABAB;
                cursor: not-allowed;
            }
            #colorToggle {
                height: 2.5rem;
                width: 2.5rem;
                border-radius: 0.25rem;
                box-shadow: var(--shadow);
                background-color: #535353;
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }
            #colorToggle.darkmode {
                background-color: #efefef;
            }
            #colorToggle > div {
                height: 60%;
                width: 60%;
                border-radius: 2rem;
                background-color: #858585;
            }
            #colorToggle.darkmode > div {
                background-color: #cdcdcd;
            }
            .sectionDescription {
                border-bottom: 1px solid var(--color-border);
                padding: 1rem;
            }
            .sectionContent {
                padding: 1rem;
            }
            .cardItem {
                width: 100%;
                padding: 1rem;
                box-sizing: border-box;
                user-select: none;
                cursor: pointer;
                transition-duration: 150ms;
                border-radius: .5rem;
            }
            .cardItem:hover {
                background-color: var(--color-darker);
            }
            .activeItem {
                background-color: var(--color-selected);
            }
            .cardInfo {
                display: flex;
                flex-direction: row;
                align-items: flex-start;
                justify-content: flex-start;
                gap: 1rem;
                width: 100%;
                border-bottom: 1px solid var(--color-border);
                overflow: hidden;
                margin-bottom: 1rem;
            }
            .cardInfoBox {
                display: none;
                /*display: flex;*/
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 0.25rem;
                padding: .5rem 1rem;
                border-radius: .5rem;
                width: 100%;
                border: 1px solid var(--color-border);
                margin-top: 1rem;
                width: 100%;
            }
            .cardInfoRules {
                flex-direction: column;
                align-items: flex-start;
                padding-bottom: 1rem;
                border-bottom: 1px solid var(--color-border);
            }
            .cardInfoRules > h4 {
                margin: 0;
            }
            .cardRuleFull {
                border-bottom: 1px solid var(--color-border);
            }
            .cardRuleFull h3 {
                margin-bottom: .5rem;
            }
            .cardRuleSet h2 {
                font-size: 4rem;
                line-height: 4rem;
                margin: 1rem 0;
            }
            embed {
                height: 60vh;
            }
            object {
                height: 60vh;
                margin-top: 2rem;
            }
            .contentContainer > div:not(.sectionDescription):not(.sectionContent) {
                margin-top: 2rem;
            }
            .contentcontainer {
                max-width: 100%;
                width: 100%;
                overflow-wrap: break-word;
            }
            #ruleClarificationContainer > div, #policyClarificationContainer > div {
                padding: 1rem;
                box-sizing: border-box;
            }
            #ruleClarificationContainer h2, #ruleClarificationContainer h3, #policyClarificationContainer h2, #policyClarificationContainer h3 {
                margin: 0;
            }
            .pdfLink {
                font-weight: bold;
                font-size: 1.5rem;
            }
            .pdfMessage {
                font-weight: bold;
                font-size: 1.5rem;
                color: var(--color-error);
            }
            #crFallback, #cegFallback {
                max-height: 60vh;
                overflow: auto;
                max-width: 100%;
            }
            #crFallback > div, #cegFallback > div {
                max-width: 100%;
            }
            #crFallback > div > img, #cegFallback > div > img {
                max-width: 100%;
            }
            .cardItem > div:first-child {
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }
            .cardItem > div:first-child img {
                max-height: 2rem;
                height: 2rem;
                width: auto;
            }
            .cardInfo, .cardInfoRules {
                user-select: text;
                cursor: default;
            }
            .moveArrows {
                display: flex;
                display: none;
                flex-direction: row;
                align-items: center;
                justify-content: center;
                width: 100%;
                gap: 24px;
            }
            .moveArrows > div {
                cursor: pointer;
                user-select: none;
                height: 24px;
                width: 24px;
                fill: var(--color-text);
            }
            .stickyContent h1 svg {
                display: none;
            }

            /* Responsive Styling */
            @media screen and (max-width: 1024px) {
                div.content {
                    width: 768px;
                    margin: auto;
                }
            }
            @media screen and (max-width: 768px) {
                html {
                    --font-size: 16px;
                }
                div.content {
                    width: 480px;
                    margin: auto;
                }
                .cardItem > div:first-child {
                    flex-direction: column;
                    align-items: flex-start;
                    justify-content: flex-start;
                }
            }
            @media screen and (max-device-width: 768px) {
                html {
                    --font-size: 16px;
                }
                .cardItem > div:first-child {
                    flex-direction: column;
                    align-items: flex-start;
                    justify-content: flex-start;
                }
            }
            @media screen and (max-width: 480px) {
                div.content {
                    width: 360px;
                    margin: auto;
                }
            }
            @media screen and (min-width: 1024px) {
                div.content {
                    width: 1024px;
                    margin: auto;
                }
            }
            .mobilecalced {
                font-size: 30px;
            }
            .mobilecalced .cardImage {
                width: 100%;
            }
            .mobilecalced search ::placeholder {
                font-size: 30px;
            }
            .mobilecalced search input {
                font-size: 30px;
            }
            .mobilecalced nav {
                display: none;
            }
            .mobilecalced .stickyContent h1 {
                display: flex !important;
                flex-direction: row;
                align-items: flex-start;
                justify-content: space-between;
            }
            .mobilecalced .stickyContent h1 svg {
                display: flex !important;
                height: 64px;
                padding: 0 24px;
                fill: var(--color-text);
                cursor: pointer;
            }
            .mobilecalced .moveArrows {
                justify-content: space-between;
            }
            .mobilecalced .moveArrows > div {
                height: 64px;
                width: 64px;
            }

            /* Custom Scrollbar CSS */
            /* Scrollbar */
            ::-webkit-scrollbar {
                width: 10px;
                height: 10px;
            }

            /* Scrollbar Track */
            ::-webkit-scrollbar-track {
                background-color: transparent;
                border-radius: 4px;
            }

            /* Scrollbar Thumb */
            ::-webkit-scrollbar-thumb {
                background-color: #ccc;
                border-radius: 4px;
                box-shadow: var(--shadow-inset);
            }

            /* Scrollbar Thumb Hover */
            ::-webkit-scrollbar-thumb:hover {
                background-color: #aaa;
            }

            /* Scrollbar Button */
            ::-webkit-scrollbar-button {
                display: none;
            }
        </style>
        <script>
            var cardData = window.projectNamespace.cardData;
            var pdfImages = {
                cr: window.projectNamespace.cr,
                ceg: window.projectNamespace.ceg
            };
            var aspectImages = {
                'Vigilance': '<img src="https://cdn.starwarsunlimited.com/icon_vigilance_aebda7026f.png" />',
                'Command': '<img src="https://cdn.starwarsunlimited.com/icon_command_df837f32c6.png" />',
                'Aggression': '<img src="https://cdn.starwarsunlimited.com/icon_aggression_24cc746635.png" />',
                'Cunning': '<img src="https://cdn.starwarsunlimited.com/icon_cunning_931f93ee4c.png" />',
                'Villainy': '<img src="https://cdn.starwarsunlimited.com/icon_villainy_eb77e7874b.png" />',
                'Heroism': '<img src="https://cdn.starwarsunlimited.com/icon_heroism_99d152cb2d.png" />'
            }

            function checkSize() {
                var ratio = window.devicePixelRatio;
                var width = window.innerWidth;
                var actualwidth = width / ratio;

                //console.log(ratio);
                //console.log(width);
                //console.log(actualwidth);
                //console.log(actualwidth <= 1024 && ratio > 1);

                if (actualwidth <= 1024 && ratio > 1) {
                    $('html').addClass('mobilecalced');
                    $('nav').hide();
                } else {
                    $('html').removeClass('mobilecalced');
                    $('nav').css('display', 'flex').show();
                }
            }

            function updateSearch() {
                const searchText = $('#searchInput').val().toLowerCase();

                // Start looping through the cards and show / hide containers that don't contain the string.
                $('.cardItem').hide();
                $('.cardInfo').hide();
                $('.cardInfoRules').hide();
                $('.activeItem').removeClass('activeItem');
                $('.cardItem').each(function () {
                    if ($(this).html().toLowerCase().includes(searchText)) {
                        $(this).show();
                    }
                });

                $('.cardRuleSet').hide();
                $('.cardRuleFull').hide();
                $('.cardRule').hide();

                $('.cardRule').each(function () {
                    if ($(this).html().toLowerCase().includes(searchText) || $(this).closest('.cardRuleFull').find('h3').text().toLowerCase().includes(searchText) || $(this).closest('.cardRuleSet').find('h2').text().toLowerCase().includes(searchText)) {
                        $(this).show();
                        $(this).closest('.cardRuleFull').show();
                        $(this).closest('.cardRuleSet').show();
                    }
                });
            }

            function createCardList() {
                if (Object.keys(cardData).length > 0) {
                    const sortedCardList = Object.keys(cardData).sort().reduce((acc, key) => {
                        acc[key] = cardData[key];
                        return acc;
                    }, {});

                    var cardListHTML = '';
                    Object.entries(sortedCardList).forEach(([cardKey, cardInfo]) => {
                        cardListHTML += '<div class="cardItem" onclick="toggleShow(event);"><div><span>' + cardKey + (cardInfo.sets.length > 0 || cardInfo.type != '' ? ' [' : '') + (cardInfo.type != '' ? cardInfo.type : '') + (cardInfo.sets.length > 0 ? (cardInfo.type != '' ? ' - ' : '') + cardInfo.sets.join(', ') : '') + (cardInfo.sets.length > 0 || cardInfo.type != '' ? ']' : '') + '</span><div data-traits="' + cardInfo.traits + '" data-aspcts="' + (cardInfo.aspects.length > 0 ? cardInfo.aspects.join(', ') : '') + '">' + (cardInfo.aspects.length > 0 ? cardInfo.aspects.map(x => aspectImages[x]).join('') : '') + '</div></div>';
                            
                        if (cardInfo.versions.length > 1) {
                            cardListHTML += '<div class="moveArrows"><div class="movePrev" onclick="moveImages(\'previous\', $(\'.cardInfo.' + cardKey.replaceAll(' ', '_').replaceAll("'", "").replace(/[^\w\s]/gi, "") + '\'));"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M177.5 414c-8.8 3.8-19 2-26-4.6l-144-136C2.7 268.9 0 262.6 0 256s2.7-12.9 7.5-17.4l144-136c7-6.6 17.2-8.4 26-4.6s14.5 12.5 14.5 22l0 72 288 0c17.7 0 32 14.3 32 32l0 64c0 17.7-14.3 32-32 32l-288 0 0 72c0 9.6-5.7 18.2-14.5 22z"/></svg></div><div class="moveNext" onclick="moveImages(\'next\', $(\'.cardInfo.' + cardKey.replaceAll(' ', '_').replaceAll("'", "").replace(/[^\w\s]/gi, "") + '\'));"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M334.5 414c8.8 3.8 19 2 26-4.6l144-136c4.8-4.5 7.5-10.8 7.5-17.4s-2.7-12.9-7.5-17.4l-144-136c-7-6.6-17.2-8.4-26-4.6s-14.5 12.5-14.5 22l0 72L32 192c-17.7 0-32 14.3-32 32l0 64c0 17.7 14.3 32 32 32l288 0 0 72c0 9.6 5.7 18.2 14.5 22z"/></svg></div></div>';
                        }
                        
                        cardListHTML += '<div class="cardInfo ' + cardKey.replaceAll(' ', '_').replaceAll("'", "").replace(/[^\w\s]/gi, "") + '" style="display: none;">';

                        for (let i = 0; i < cardInfo.versions.length; i++) {
                            cardListHTML += '<div class="cardInfoBox">' +
                                    (cardInfo.versions[i].variant_name !== '' ? '<div><strong>' + cardInfo.versions[i].variant_name + '</strong></div>' : '') +
                                    (cardInfo.versions[i].front_image !== '' ? '<img class="cardImage frontImage" src="' + cardInfo.versions[i].front_image + '" alt="' + cardKey + ' - Front" />' : '') +
                                    (cardInfo.versions[i].back_image !== '' ? '<img class="cardImage backImage" src="' + cardInfo.versions[i].back_image + '" alt="' + cardKey + ' - Back" />' : '') +
                                    (cardInfo.versions[i].text !== '' ? '<div><strong>Card Text:</strong> ' + cardInfo.versions[i].text.replaceAll("'", "\'") + '</div>' : '') +
                                    (cardInfo.versions[i].deploy_box !== '' ? '<div><strong>Deploy Box Text:</strong> ' + cardInfo.versions[i].deploy_box.replaceAll("'", "\'") + '</div>' : '') +
                                    (cardInfo.versions[i].epic_action !== '' ? '<div><strong>Epic Action Text:</strong> ' + cardInfo.versions[i].epic_action.replaceAll("'", "\'") + '</div>' : '') +
                                '</div>';
                        }
                        
                        cardListHTML += '</div>';

                        if (cardInfo.rules.length > 0) {
                            cardListHTML += '<div class="cardInfoRules ' + cardKey.replaceAll(' ', '_').replaceAll("'", "").replace(/[^\w\s]/gi, "") + '" style="display: none;">';
                                cardListHTML += '<h4>Rules:</h4>';
                            for (let i = 0; i < cardInfo.rules.length; i++) {
                                cardListHTML += '<div class="cardInfoRulesBox">' +
                                        '<div><strong>' + cardInfo.rules[i][0] + ':</strong> ' + cardInfo.rules[i][1] + '</div>' +
                                    '</div>';
                            }
                            cardListHTML += '</div>';
                        }
                        cardListHTML += '</div>';
                    });

                    $('#cardContent').html(cardListHTML);
                }
            }

            function createRulesList() {
                if (Object.keys(cardData).length > 0) {
                    var allRules = [];

                    Object.entries(cardData).forEach(([cardKey, cardInfo]) => {
                        if (cardInfo.rules.length > 0) {
                            var recentSetName = '';
                            var recentSetNumber = 0;
                            for (let i = 0; i < cardInfo.versions.length; i++) {
                                if (cardInfo.versions[i].set_number > recentSetNumber) {
                                    recentSetName = cardInfo.versions[i].set;
                                    recentSetNumber = cardInfo.versions[i].set_number;
                                }
                            }
                            for (let i = 0; i < cardInfo.rules.length; i++) {
                                allRules.push([recentSetName, cardKey, cardInfo.rules[i][0], cardInfo.rules[i][1], recentSetNumber]);
                            }
                        }
                    });

                    allRules = allRules.sort(function(a, b) {
                        if (a[4] != b[4]) {
                            return b[4] - a[4];
                        } else {
                            if (a[1] != b[1]) {
                                return a[1].localeCompare(b[1]);
                            } else {
                                if (a[2] != b[2]) {
                                    return new Date(b[2]) - new Date(a[2]);
                                } else {
                                    if (a[3] != b[3]) {
                                        return a[3].localeCompare(b[3]);
                                    } else {
                                        return 0;
                                    }
                                }
                            }
                        }
                    });

                    var ruleHTML = '';
                    var previousSet = '';
                    var previousCard = '';
                    for (let i = 0; i < allRules.length; i++) {
                        if (allRules[i][0] != previousSet && previousSet != '') {
                            ruleHTML += '</div>';
                        }
                        if (allRules[i][1] != previousCard && previousCard != '') {
                            ruleHTML += '</div>';
                        }

                        if (allRules[i][0] != previousSet) {
                            ruleHTML += '<div class="cardRuleSet"><h2>' + allRules[i][0] + '</h2>';
                            previousSet = allRules[i][0];
                        }
                        if (allRules[i][1] != previousCard) {
                            ruleHTML += '<div class="cardRuleFull"><h3>' + allRules[i][1] + '</h3>';
                            previousCard = allRules[i][1];
                        }
                        ruleHTML += '<div class="cardRule"><strong>' + allRules[i][2] + ':</strong> ' + allRules[i][3] + '</div>';
                    }
                    ruleHTML += '</div></div>';

                    $('#ruleContent').html(ruleHTML);
                }
            }
            
            function fixMarkdown(markdown) {
                const mdSplit = markdown.split('\n');

                var markdownLines = [];
                var inbullets = false;
                for (let i = 0; i < mdSplit.length; i++) {
                    var fixedMd = mdSplit[i].trim();
                    if (fixedMd === '') {
                        markdownLines.push('<br />');
                        continue;
                    }
                    if (fixedMd.substring(0, 2) === '# ') {
                        fixedMd = '<h2>' + fixedMd.substring(2) + '</h2>';
                    }
                    if (fixedMd.substring(0, 3) === '## ') {
                        fixedMd = '<h3>' + fixedMd.substring(3) + '</h3>';
                    }
                    if (fixedMd.substring(0, 2) === '* ') {
                        if (!inbullets) {
                            inbullets = true;
                            fixedMd = '<ul><li>' + fixedMd.substring(2) + '</li>';
                        } else {
                            fixedMd = '<li>' + fixedMd.substring(2) + '</li>';
                        }
                    } else if (inbullets) {
                        inbullets = false;
                        fixedMd = '</ul>' + fixedMd;
                    }

                    fixedMd = fixedMd.replace(/\[(.*?)\]\((.*?)\)/g, (match, p1, p2) => {
                        if (p1 === 'Screenshot') {
                            return `<img style="max-width: 100%;" src="${p2}" />`;
                        }
                        return `<!--<a href="${p2}">-->${p1}<!--</a>-->`;
                    });

                    // Part to handle adding the bolds
                    fixedMd = fixedMd.replace(/(.*?)\*\*(.*?)\*\*/g, "$1<b>$2</b>");
                    // Part to handle adding what I think is italics
                    fixedMd = fixedMd.replace(/(.*?)\*(.*?)\*/g, "$1<i>$2</i>");
                    markdownLines.push(fixedMd);
                }

                return markdownLines.join('');
            }

            function toggleShow(target) {
                var clicked = $(target.target);
                var parent = clicked.closest('.cardItem')[0];

                var doNotToggle = false;
                if (clicked.closest('.moveArrows').length > 0 || clicked.hasClass('cardInfo') || clicked.hasClass('cardInfoRules') || clicked.closest('.cardInfo').length > 0 || clicked.closest('.cardInfoRules').length > 0) {
                    doNotToggle = true;
                }

                if (!doNotToggle) {
                    if ($(parent).hasClass('activeItem')) {
                        $('.cardInfo').hide();
                        $('.cardInfoBox').hide();
                        $('.cardInfoRules').hide();
                        $('.moveArrows').hide();
                        $('.cardItem').removeClass('activeItem');
                    } else {
                        $('.cardItem').removeClass('activeItem');
                        $(parent).addClass('activeItem');
                        $('.cardInfo').hide();
                        $('.cardInfoBox').hide();
                        $('.cardInfoRules').hide();
                        $('.moveArrows').hide();
                        $(parent).children('.cardInfo').css('display', 'flex').show();
                        $(parent).children('.moveArrows').css('display', 'flex').show();
                        $(parent).children('.cardInfoRules').css('display', 'flex').show();
                        $(parent).children('.cardInfo').children('.cardInfoBox:first-child()').css('display', 'flex').show();
                    }
                }
            }

            function moveImages(direction, cardInfo) {
                const cardInfoBoxes = cardInfo.children('.cardInfoBox');
                const currentInfoBox = cardInfo.children('.cardInfoBox:visible')[0];
                const currentIndex = Array.prototype.indexOf.call(cardInfoBoxes, currentInfoBox);
                var nextIndex = -1;
                var nextInfoBox;

                if (direction === 'next') {
                    nextIndex = currentIndex + 1;

                    if (nextIndex > cardInfoBoxes.length - 1) {
                        nextInfoBox = cardInfoBoxes[0];
                    } else {
                        nextInfoBox = cardInfoBoxes[nextIndex];
                    }

                    $(currentInfoBox).hide();
                    $(nextInfoBox).css('display', 'flex').show();
                } else if (direction === 'previous') {
                    nextIndex = currentIndex - 1;

                    if (nextIndex < 0) {
                        nextInfoBox = cardInfoBoxes[cardInfoBoxes.length - 1];
                    } else {
                        nextInfoBox = cardInfoBoxes[nextIndex];
                    }

                    $(currentInfoBox).hide();
                    $(nextInfoBox).css('display', 'flex').show();
                }
            }

            function toggleMenu() {
                if ($('nav').css('display') === 'none') {
                    $('nav').css('display', 'flex').show();
                } else {
                    $('nav').hide();
                }
            }

            // Uses https://www.adobe.com/acrobat/online/pdf-to-jpg.html to convert a PDF to a png per page.
            docLoaded = function(docType) {
                const pdfDoc = $('#' + docType + 'Container > object').contents();

                var hasDoc = false;
                for (let i = 0; i < pdfDoc.length; i++) {
                    if ('nodeName' in pdfDoc[0] && pdfDoc[0].nodeName === '#document') {
                        hasDoc = true;
                        break;
                    }
                }

                if (!hasDoc && $('#' + docType + 'Container').is(':visible')) {
                    $('#' + docType + 'Container > object').hide();
                    $('#' + docType + 'Container > .pdfMessage').show();
                    $('#' + docType + 'Fallback').show();
                } else {
                    $('#' + docType + 'Container > object').show();
                    $('#' + docType + 'Container > .pdfMessage').hide();
                    $('#' + docType + 'Fallback').hide();
                }
            }

            main = function () {
                checkSize();

                createCardList();
                createRulesList();

                const rulesGistID = "256a534a98fc1d45f2595503f7d54953";
                const policyGistID = "c3f860fba8e866c313aaac05f114e119"
                const apiRulesUrl = `https://api.github.com/gists/${rulesGistID}`;
                const apiPolicyUrl = `https://api.github.com/gists/${policyGistID}`;
                fetch(apiRulesUrl) 
                .then(response => response.json())
                .then(result => {
                    console.log(result);
                    if (result.files["SWU_Rules.md"]["content"] !== undefined && result.files["SWU_Rules.md"]["content"] !== null) {
                        const markdownContent = result.files["SWU_Rules.md"]["content"];

                        const fixedMd = fixMarkdown(markdownContent);
                        $('#ruleClarificationContainer > div').html(fixedMd);
                    }
                });
                
                fetch(apiPolicyUrl) 
                .then(response => response.json())
                .then(result => {
                    if (result.files["SWU_Policy.md"]["content"] !== undefined && result.files["SWU_Policy.md"]["content"] !== null) {
                        const markdownContent = result.files["SWU_Policy.md"]["content"];

                        const fixedMd = fixMarkdown(markdownContent);
                        $('#policyClarificationContainer > div').html(fixedMd);
                    }
                });

                for (const place in pdfImages) {
                    if (pdfImages[place].length > 0) {
                        
                        var fallbackHTML = '';

                        var sortedFiles = pdfImages[place].sort(function (a, b) {
                            return parseInt(a.split('_')[a.split('_').length - 1]) - parseInt(b.split('_')[b.split('_').length - 1]);
                        });
                        for (let i = 0; i < sortedFiles.length; i++) {
                            fallbackHTML += '<img src="rules_documents/' + place.toUpperCase() + '/' + sortedFiles[i] + '" />';
                        }

                        if (fallbackHTML != '') {
                            $('#' + place + 'Fallback > div').html(fallbackHTML);
                        }
                    }
                }
            }

            main();
            $(window).resize(checkSize);
            /*
            $(document).ready(function() {
                $('img[loading="lazy"]').attr('loading', 'auto');
            });
            */
        </script>
    </body>
</html>